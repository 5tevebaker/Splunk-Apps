

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Troubleshooting &mdash; Palo Alto Networks App for Splunk v5.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Palo Alto Networks App for Splunk v5.0.0 documentation" href="index.html"/>
        <link rel="next" title="Trail and Demo" href="trial_demo.html"/>
        <link rel="prev" title="Frequently Asked Questions" href="faq.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Palo Alto Networks App for Splunk
          

          
          </a>

          
            
            
              <div class="version">
                v5.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="userid.html">User-ID with Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Searchbar Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="universal_forwarder.html">Syslog-ng and Universal Forwarder</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#common-problems-and-solutions">Common Problems and Solutions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#problem-after-upgrading-the-app-add-on">Problem after upgrading the App/Add-on</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dashboards-not-working">Dashboards not working</a></li>
<li class="toctree-l3"><a class="reference internal" href="#no-wildfire-data">No WildFire Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting-steps">Troubleshooting Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="trial_demo.html">Trail and Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Get Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Palo Alto Networks App for Splunk</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Troubleshooting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/troubleshoot.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="troubleshooting">
<span id="troubleshoot"></span><h1>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="common-problems-and-solutions">
<h2>Common Problems and Solutions<a class="headerlink" href="#common-problems-and-solutions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-after-upgrading-the-app-add-on">
<h3>Problem after upgrading the App/Add-on<a class="headerlink" href="#problem-after-upgrading-the-app-add-on" title="Permalink to this headline">¶</a></h3>
<p>Check the <a class="reference internal" href="release_notes.html#releasenotes"><span class="std std-ref">Release Notes</span></a> for actions needed during App/Add-on
upgrade and ensure you completed all required actions for upgrade.</p>
<p>When upgrading any app in Splunk, configuration created by the Splunk
administrator is leftover in the app&#8217;s <cite>local</cite> directory. If the file in the
<cite>local</cite> directory in the app is not compatible with the new version, then
unexpected problems can happen.  This is true for all apps in Splunk and a
best practice is to backup and delete the <cite>local</cite> directory in the app after
upgrading it if there are problems after the upgrade. Note that you might
need to leave <cite>inputs.conf</cite> if that is how your logs are getting into Splunk.</p>
</div>
<div class="section" id="dashboards-not-working">
<h3>Dashboards not working<a class="headerlink" href="#dashboards-not-working" title="Permalink to this headline">¶</a></h3>
<p><strong>All dashboards have no data</strong></p>
<p>Perform a search for <code class="docutils literal"><span class="pre">eventtype=pan</span></code> with &#8216;All time&#8217; as the timeframe. If
logs show up, then verify the timestamp of the logs is correct. If it is wrong,
check that the clock and timezone on the Firewall/Panorama matches the Splunk
server, or use NTP on both. See Troubleshooting Step 2 below for more detail.</p>
<p><strong>Only &#8216;Overview&#8217; dashboard has data</strong></p>
<p>The &#8216;Overview&#8217; dashboard has data, but other dashboards do not,
usually the datamodel is not fully built.  This can happen on a
Splunk server with not enough resources to summary index the data as
it comes in. Increase the time range on the dashbaords with no data
to &#8216;All Time&#8217; to see if data shows up. Check the datamodel to see if
it is 100% built.  See Troubleshooting Step 4 below for more detail.</p>
<p><strong>&#8216;Overview&#8217; dashboard has no data</strong></p>
<p>The &#8216;Overview&#8217; dashboards has no data, but other dashboards work correctly,
the clock on your firewall is a few minutes off, or the timezone is set wrong.
The &#8216;Overview&#8217; dashboard is a real-time 5 minute search, while the other
dashboards pull a larger timeframe from the data model. So the &#8216;Overview&#8217; is
more suseptible to minor variations in system clock.  Please verify the clock
and timezone on Splunk and the Firewall/Panorama are set exactly the same.</p>
</div>
<div class="section" id="no-wildfire-data">
<h3>No WildFire Data<a class="headerlink" href="#no-wildfire-data" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="advanced.html#wildfire"><span class="std std-ref">WildFire</span></a> dashboard is empty or no WildFire
data is appearing in the index. For Splunk to take advantage of
WildFire, you log WildFire events from the Firewall/Panorama
first. Splunk will leverage the WildFire cloud API to pull reports
and IOC&#8217;s from the WildFire analysis only after it receives
notification of the WildFire event from the Firewall/Panorama.</p>
<p>Some things to check to get WildFire data into Splunk:</p>
<ul class="simple">
<li>If upgrading to App 5.3 or higher from a version before 5.3, you must
set the WildFire API key in the Add-on Setup Screen, even if you
previously set it in the App. See the <span class="xref std std-ref">release notes</span> for
more information.</li>
<li>Verify there are WildFire Submission logs
in the Monitor tab on the Firewall/Panorama</li>
<li>Verify WildFire logs are enabled in the Log Forwarding Profile
on the Security policy rule which is generating WildFire events</li>
<li>Verify WildFire events are received by Splunk
with this search: <code class="docutils literal"><span class="pre">eventtype=pan_wildfire</span></code></li>
<li>If there are WildFire events (syslogs), verify there are also WildFire
reports (XML) with this search: <code class="docutils literal"><span class="pre">eventtype=pan_wildfire_report</span></code></li>
<li>If there are WildFire events (syslogs) but not WildFire
reports (XML), check the report gathering logs for
errors in <code class="docutils literal"><span class="pre">$SPLUNK_HOME/var/log/splunk/python.log</span></code>.</li>
<li>Check that you have configured the TA with the WildFire API
Key, especially if upgrading from a pre-5.3 version of the App.</li>
</ul>
</div>
</div>
<div class="section" id="troubleshooting-steps">
<h2>Troubleshooting Steps<a class="headerlink" href="#troubleshooting-steps" title="Permalink to this headline">¶</a></h2>
<p>Follow these troubleshooting steps if there are problems getting the
dashboards to show data.</p>
<p><strong>Step 1.  Check that all initial configuration is complete</strong></p>
<ul class="simple">
<li>Verify inputs.conf is set up per the <a class="reference internal" href="getting_started.html#datainput"><span class="std std-ref">instructions</span></a>.
inputs.conf must have the line <code class="docutils literal"><span class="pre">no_appending_timestamp</span> <span class="pre">=</span> <span class="pre">true</span></code> for UDP
syslogs</li>
<li>Check for other inputs.conf outside the App or Add-on that might be using
the same port</li>
<li>Check the firewall is not using a Custom Log Format (must use the
default log format)</li>
<li>Check the Endpoint Security Manager is using CEF format</li>
<li>Check the firewall is set to log something like system events, config
events, traffic events, and so on.</li>
<li>Check that the clocks and timezones on the firewall and Splunk server are
the same.  If they are different, logs will not show up correctly.</li>
<li>If using a TCP or SSL port for syslogs, try UDP instead, then switch
to TCP or SSL once UDP is working</li>
</ul>
<p><strong>Step 2.  Verify logs are indexed</strong></p>
<p>Use the method described in the <a class="reference internal" href="getting_started.html#test"><span class="std std-ref">Test the configuration</span></a> section
to produce some syslogs. Verify the logs are reaching the Splunk server by
navigating to the Splunk for Palo Alto Networks app, click &#8216;Search&#8217; in the
navigation bar, then enter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">eventtype</span><span class="o">=</span><span class="n">pan</span>
</pre></div>
</div>
<img alt="_images/test_pan.png" src="_images/test_pan.png" />
<p>If no logs show up, then the logs are not getting indexed correctly. Use
these steps to find the problem:</p>
<ul class="simple">
<li>Verify the configuration from Step 1 above.</li>
<li>Switch the search timeframe to All Time. If logs show up, verify the
timestamp is correct on the logs. If time is wrong, check that the Splunk
server and firewall have the same time and timezone set. Use NTP if possible.</li>
<li>Use tcpdump or Wireshark on the Splunk server to verify the logs are
actually reaching it.</li>
<li>Verify the App (and Add-on when using App v5.0 and higher) is installed on
all searchheads, indexers, and heavy forwarders.</li>
<li>If using App v3.x or 4.x, verify the pan_logs index exists.</li>
</ul>
<p><strong>Step 3. Verify logs are parsed correctly</strong></p>
<p>Use the method described above in the <a class="reference internal" href="getting_started.html#test"><span class="std std-ref">Test the configuration</span></a>
section to produce some syslogs. Verify the logs are reaching the Splunk
server by navigating to the Palo Alto Networks App, click &#8216;Search&#8217; in the
navigation bar, and enter the following search:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">eventtype</span><span class="o">=</span><span class="n">pan_config</span>
</pre></div>
</div>
<img alt="_images/test_pan_config.png" src="_images/test_pan_config.png" />
<p>If logs showed in step 2, but no logs show up now, then the logs are not
getting parsed correctly:</p>
<ul class="simple">
<li>Check that you are not using a Custom Log Format in the syslog server
setting on the firewall.</li>
<li>Check that the inputs.conf file is configured with the line
&#8220;no_appending_timestamp = true&#8221; if using UDP syslogs.</li>
<li>If you&#8217;re using a third-party syslog forwarder between the Palo Alto
Networks device and Splunk, verify the forwarder isn&#8217;t modifying the logs.</li>
<li>Verify the App (and Add-on when using App v5.0 and higher) is installed on
all searchheads, indexers, and heavy forwarders.</li>
</ul>
<p><strong>Step 4.  Check acceleration and summary indexing</strong></p>
<img alt="_images/troubleshooting_dashboard.png" src="_images/troubleshooting_dashboard.png" />
<p>Check that the dashboards are populating with data. The Overview dashboard
doesn&#8217;t use acceleration, so it should work at this point. If it doesn&#8217;t,
then go back to the previous troubleshooting steps. For all the other
dashboards, after 5-8 minutes of syslogging to the Splunk server, the
dashboards should populate with data. If the dashboards are populating,
then acceleration and summary indexing are working. If not, check the
following:</p>
<dl class="docutils">
<dt>App Version 4.0 and earlier:</dt>
<dd>Uses TSIDX for acceleration.</dd>
</dl>
<ul class="simple">
<li>Verify that saved searches for log collection are in the savedsearches.conf
file. Check that they haven&#8217;t been changed or overwritten.</li>
</ul>
<dl class="docutils">
<dt>App Version 4.1 and later:</dt>
<dd>Uses Data Model for acceleration.</dd>
</dl>
<ul class="simple">
<li>Check acceleration settings in the data model under Settings &gt; Data Model &gt;
and fine the Palo Alto Networks datamodels. (There may be 1 or 3 datamodels
depending on the App version)</li>
<li>Verify that acceleration is enabled for all Palo Alto Networks datamodels.</li>
<li>Click the arrow next to the Palo Alto Networks data models and check the
data model build percentage. It should be 100% or very close to it.</li>
<li>If the build percentage is stuck at less than 90%, the cause might be
limited resources on the Splunk server being consumed by other apps. Try
disableing unused apps, removing acceleration from other datamodels,
or adding hardware resources. If you need help troubleshooting performance
problems with datamodels, you can open a case with Splunk Support. Note
that Splunk Support will not troubleshoot the Palo Alto Networks App, but
they can tell you what is causing any performance problems that prevent
your datamodels from accelerating fast enough to keep up with new data.</li>
</ul>
<p><strong>Step 5.  Get support</strong></p>
<p>If you get to the end of these troubleshooting steps and you still can&#8217;t figure
out what&#8217;s wrong, please search <a class="reference external" href="https://answers.splunk.com/app/questions/491.html">Splunk Answers</a> or ask a question using the
information on the <a class="reference internal" href="support.html#getsupport"><span class="std std-ref">Get Support</span></a> page.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="trial_demo.html" class="btn btn-neutral float-right" title="Trail and Demo" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="faq.html" class="btn btn-neutral" title="Frequently Asked Questions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2016, Palo Alto Networks, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'v5.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>